<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Real-time Timbre Remapping with Differentiable DSP | Jordie Shier</title> <meta name="author" content="Jordie Shier"/> <meta name="description" content="Jordie Shier's personal portfolio website "/> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img/icons8-electronic-music-96.png"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://jordieshier.com/projects/nime2024/"> <link href="https://vjs.zencdn.net/8.16.1/video-js.css" rel="stylesheet"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://jordieshier.com/"><span class="font-weight-bold">Jordie</span> Shier</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/research/">research</a> </li> <li class="nav-item"> <a class="nav-link" href="https://docs.google.com/document/d/17S34bJpOV2ZWR74AiIugc4J4l5EJ58fO/export?format=pdf" target="_blank" rel="noopener noreferrer">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Real-time Timbre Remapping with Differentiable DSP</h1> <p class="post-description"></p> </header> <article> <p style="text-align: center;">Jordie Shier, Charalampos Saitis, Andrew Robertson, and Andrew McPherson</p> <p><br></p> <div align="center"> <a href="https://github.com/jorshi/ddsp-timbre-remap" target="_blank" rel="noopener noreferrer"><i class="fab fa-github"></i> <b>Training Code</b></a> | <a href="https://drive.google.com/file/d/1m-fi_L9U__gK7VpXv2tWOnBkRhUej08r/view?usp=drive_link" target="_blank" rel="noopener noreferrer"><i class="fas fa-headphones"></i> <b>Audio Plugin</b></a> | <a href="https://colab.research.google.com/drive/1nwV5y2eYiCF9YIM1BSmKU9uiPBbw9OxV?usp=sharing" target="_blank" rel="noopener noreferrer"><i class="fas fa-laptop-code"></i> <b>Google Colab</b></a> | <a href="https://arxiv.org/abs/2407.04547" target="_blank" rel="noopener noreferrer"><i class="fas fa-paperclip"></i> <b>Paper</b></a> </div> <p><br></p> <h2 id="abstract">Abstract</h2> <div> Timbre is a primary mode of expression in diverse musical contexts. However, prevalent audio-driven synthesis methods predominantly rely on pitch and loudness envelopes, effectively flattening timbral expression from the input. Our approach draws on the concept of timbre analogies and investigates how timbral expression from an input signal can be mapped onto controls for a synthesizer. Leveraging differentiable digital signal processing, our method facilitates direct optimization of synthesizer parameters through a novel feature difference loss. This loss function, designed to learn relative timbral differences between musical events, prioritizes the subtleties of graded timbre modulations within phrases, allowing for meaningful translations in a timbre space. Using snare drum performances as a case study, where timbral expression is central, we demonstrate real-time timbre remapping from acoustic snare drums to a differentiable synthesizer modeled after the Roland TR-808. </div> <p><br></p> <h2 id="presentation">Presentation</h2> <iframe width="560" height="315" src="https://www.youtube.com/embed/IVaNfp4rev0?si=_Ja3pAfqm_34z5bH" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen=""></iframe> <p><br></p> <h2 id="demos">Demos</h2> <p>These demos were recorded with professional drummer <a href="https://www.instagram.com/oneupdrumvids/?hl=en" target="_blank" rel="noopener noreferrer">Carson Gant</a> using a prototype audio plug-in. All models used in these videos were trained on short (~1min) recordings of Carson playing and all recordings were created in real-time.</p> <h3 id="short-overview-demo">Short Overview Demo</h3> <p>Short performance passages followed by the synthesized version. A few different synthesizer presets are included for demonstration.</p> <iframe width="560" height="315" src="https://www.youtube.com/embed/V3ht2JhvJjA?si=ey2OYjWirZM5AGn5" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen=""></iframe> <p><br></p> <h3 id="longer-performance-demos">Longer Performance Demos</h3> <p>Two videos of the same performance are shown for each model and corresponding synth preset: one with only the synthesized audio and one with the original drum sound mixed in.</p> <h4 id="snare-preset-1">Snare Preset 1</h4> <p>Synth Only Mix:</p> <iframe width="560" height="315" src="https://www.youtube.com/embed/GuR5lGN3oeM?si=1Mf2JxN4Xdoh1uWu" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe> <p>Synth plus Drum Mix:</p> <iframe width="560" height="315" src="https://www.youtube.com/embed/jhXyEqhFnuE?si=iliz6GoLJf9Qfvgx" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe> <p><br></p> <h4 id="snare-preset-2">Snare Preset 2</h4> <p>Synth Only Mix:</p> <iframe width="560" height="315" src="https://www.youtube.com/embed/mdg_xsxcLPU?si=eO0d4EAhRCgCg5f3" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe> <p>Synth plus Drum Mix:</p> <iframe width="560" height="315" src="https://www.youtube.com/embed/FEy9pRbeJOc?si=6bvK9ZeAi4WhPJh9" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe> <p><br></p> <h4 id="snare-preset-3">Snare Preset 3</h4> <p>Synth Only Mix:</p> <iframe width="560" height="315" src="https://www.youtube.com/embed/2R55K15gUuk?si=zWN8v3EGvUSwUM__" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe> <p>Synth plus Drum Mix:</p> <iframe width="560" height="315" src="https://www.youtube.com/embed/Gyxs6uBiSPU?si=2xAxP2tHRmezRuaB" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe> <p><br></p> <h4 id="snare-preset-1---missed-hits">Snare Preset 1 - Missed Hits</h4> <p>Example of playing from quiet to loud, showing that quiet hits were not captured well with this particular onset detection setup. Cresendos on the drumhead show more dynamic range than the rim hits during synthesis.</p> <p>Synth Only Mix:</p> <iframe width="560" height="315" src="https://www.youtube.com/embed/vz6CXLjIruo?si=2N0Pe_AONdDau2KJ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe> <p>Synth plus Drum Mix:</p> <iframe width="560" height="315" src="https://www.youtube.com/embed/0ii6G0TZI1M?si=SungHmUDyM6if3oO" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe> <p><br></p> <h2 id="model-and-training-details">Model and Training Details</h2> <p>We conducted a series of numerical experiments to evaluate the performance of our differentiable timbre remapping approach. This involved training neural network mapping models to estimate synthesizer parameter modulations to match audio feature differences observed between snare drum hits in a performance. This section supplements the material in the paper with model and training details. Please refer to section 5 in the <a href="http://instrumentslab.org/data/andrew/shier_nime2024.pdf" target="_blank" rel="noopener noreferrer">paper</a> for full details and results.</p> <h3 id="mapping-models">Mapping Models</h3> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/research/nime-model-overview-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/research/nime-model-overview-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/research/nime-model-overview-1400.webp"></source> <img src="/assets/img/research/nime-model-overview.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="MLP Parameter Mapping Overview" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>This diagram shows an overview of the multi-layer perceptron (MLP) model used to map onset features to synthesizer parameter modulations. \(f_0(\cdot)\) extracts features from a short window of audio at a detected onset. The result is a feature vector with three dimensions (model input size). \(m_{\phi}(\cdot)\) is a neural network which is trained to estimate synthesizer parameter modulations \(\theta_{mod}\), which is summed with a synthesizer preset \(\theta_{pre}\). \(\theta_{pre}\) is selected prior to training and fixed. The number of synthesizer parameters is 14. Therefore, a mapping model maps from three input features to 14 output parameters.</p> <p>During numerical experiments we included a baseline linear layer for comparison. The linear model did not include layer normalization. Details of the different architectures are provided in the table below.</p> <div class="row"> <table> <thead> <tr> <th>Model</th> <th>Hidden Size</th> <th>Num Layers</th> <th>Num Params</th> <th>Activation</th> <th>Output</th> </tr> </thead> <tbody> <tr> <td>Linear</td> <td>n/a</td> <td>0</td> <td>42</td> <td>Linear</td> <td>Clamp (-1.0,1.0)</td> </tr> <tr> <td>MLP</td> <td>32</td> <td>1</td> <td>590</td> <td>ReLU</td> <td>Tanh</td> </tr> <tr> <td>MLP Lrg</td> <td>64</td> <td>3</td> <td>9500</td> <td>ReLU</td> <td>Tanh</td> </tr> </tbody> </table> </div> <p><br></p> <h3 id="training-hyperparameters">Training Hyperparameters</h3> <p>Model parameters were initialized by sampling from a normal distribution with zero mean and a standard deviation selected via hyperparameter tuning. All models were trained using an Adam optimizer for 250 epochs. The learning rate was scheduled to decrease by a factor of 0.5 when a validation loss plateaud for 20 epochs. Initial learning rates are shown in the table below.</p> <table> <thead> <tr> <th>Model</th> <th>Weight Initialization Std</th> <th>Learning Rate</th> </tr> </thead> <tbody> <tr> <td>Linear</td> <td>1e-6</td> <td>5e-3</td> </tr> <tr> <td>MLP</td> <td>1e-3</td> <td>5e-4</td> </tr> <tr> <td>MLP LRG</td> <td>1e-3</td> <td>5e-4</td> </tr> </tbody> </table> <p><br></p> <h3 id="direct-optimization">Direct Optimization</h3> <p>For numerical experiments we compared against results obtained by directly optimizing synthesizer modulation values. No models were trained. The synthesizer modulation values were treated as learned parameters and directly optimized for each drum sound in a dataset. This represents an upper-bound for mapping model performance. For this we used an Adam optimizer with a learning rate of 5e-3 which was scheduled to decrease by a factor of 0.5 after 50 iterations with no decrease in loss. Parameters were optimized for 1000 iterations.</p> </article> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> © Copyright 2025 Jordie Shier. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. <a target="_blank" href="https://icons8.com/icon/12100/electronic-music" rel="noopener noreferrer">Electronic Music</a> icon by <a target="_blank" href="https://icons8.com" rel="noopener noreferrer">Icons8</a> </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>