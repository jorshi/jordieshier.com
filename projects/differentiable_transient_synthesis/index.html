<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Differentiable Modeling of Percussive Audio with Transient and Spectral Synthesis | Jordie Shier</title> <meta name="author" content="Jordie Shier"/> <meta name="description" content="Jordie Shier's personal portfolio website "/> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img/icons8-electronic-music-96.png"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://jordieshier.com/projects/differentiable_transient_synthesis/"> <link href="https://vjs.zencdn.net/8.16.1/video-js.css" rel="stylesheet"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://jordieshier.com/"><span class="font-weight-bold">Jordie</span> Shier</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Differentiable Modeling of Percussive Audio with Transient and Spectral Synthesis</h1> <p class="post-description"></p> </header> <article> <p style="text-align: center;">Jordie Shier, Franco Caspe, Andrew Robertson, Mark Sandler, Charalampos Saitis, and Andrew McPherson</p> <p><br></p> <div align="center"> <a href="https://github.com/jorshi/drumblender" target="_blank" rel="noopener noreferrer"><i class="fab fa-github"></i> <b>Code</b></a> | <a href="/assets/pdf/shier2023differentiable_paper.pdf"><i class="fas fa-paperclip"></i> <b>Paper</b></a> </div> <p><br></p> <h3 id="abstract">Abstract</h3> <div> Differentiable digital signal processing (DDSP) techniques, including methods for audio synthesis, have gained attention in recent years and lend themselves to interpretability in the parameter space. However, current differentiable synthesis methods have not explicitly sought to model the transient portion of signals, which is important for percussive sounds. In this work, we present a unified synthesis framework aiming to address transient generation and percussive synthesis within a DDSP framework. To this end, we propose a model for percussive synthesis that builds on sinusoidal modeling synthesis and incorporates a modulated temporal convolutional network for transient generation. We use a modified sinusoidal peak picking algorithm to generate time-varying non-harmonic sinusoids and pair it with differentiable noise and transient encoders that are jointly trained to reconstruct drumset sounds. We compute a set of reconstruction metrics using a large dataset of acoustic and electronic percussion samples that show that our method leads to improved onset signal reconstruction for membranophone percussion instruments. </div> <p><br></p> <h2 id="audio-results">Audio Results</h2> <hr> <p>Here we share resynthesis results from our method on a selection of acoustic and electronic drum set sounds from our test set. \(Y\) is the ground truth audio target, \(S\) is sinudoial only using sinusoidal modeling, \(S + N\) is sines plus noise with a learned noise encoder and generator, and \(T(S) + N\) uses the learned transient encoder and modulated TCN network conditioned with a sinusoidal input and noise is summed at the ouput.</p> <table> <thead> <tr> <th>Target</th> <th>\(Y\)</th> <th>\(S\)</th> <th>\(S + N\)</th> <th>\(T(S) + N\)</th> </tr> </thead> <tbody> <tr> <td>Acoustic Kick</td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/a_kick.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/a_kick_modal.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/a_kick_noise_params.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/a_kick_noise_parallel_transient_params.mp3" type="audio/mpeg"></source></audio></td> </tr> <tr> <td>Acoustic Snare</td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/a_snare.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/a_snare_modal.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/a_snare_noise_params.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/a_snare_noise_parallel_transient_params.mp3" type="audio/mpeg"></source></audio></td> </tr> <tr> <td>Acoustic Tom</td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/a_tom.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/a_tom_modal.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/a_tom_noise_params.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/a_tom_noise_parallel_transient_params.mp3" type="audio/mpeg"></source></audio></td> </tr> <tr> <td>Acoustic Hihat</td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/a_hihat.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/a_hihat_modal.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/a_hihat_noise_params.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/a_hihat_noise_parallel_transient_params.mp3" type="audio/mpeg"></source></audio></td> </tr> <tr> <td>Acoustic Crash</td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/a_crash.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/a_crash_modal.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/a_crash_noise_params.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/a_crash_noise_parallel_transient_params.mp3" type="audio/mpeg"></source></audio></td> </tr> <tr> <td>Electronic Kick</td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/e_kick.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/e_kick_modal.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/e_kick_noise_params.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/e_kick_noise_parallel_transient_params.mp3" type="audio/mpeg"></source></audio></td> </tr> <tr> <td>Electronic Snare</td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/e_snare.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/e_snare_modal.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/e_snare_noise_params.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/e_snare_noise_parallel_transient_params.mp3" type="audio/mpeg"></source></audio></td> </tr> <tr> <td>Electronic Tom</td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/e_tom.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/e_tom_modal.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/e_tom_noise_params.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/e_tom_noise_parallel_transient_params.mp3" type="audio/mpeg"></source></audio></td> </tr> <tr> <td>Electronic Hihat</td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/e_hihat.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/e_hihat_modal.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/e_hihat_noise_params.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/e_hihat_noise_parallel_transient_params.mp3" type="audio/mpeg"></source></audio></td> </tr> <tr> <td>Electronic Crash</td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/e_crash.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/e_crash_modal.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/e_crash_noise_params.mp3" type="audio/mpeg"></source></audio></td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/e_crash_noise_parallel_transient_params.mp3" type="audio/mpeg"></source></audio></td> </tr> </tbody> </table> <p><br></p> <h2 id="spectral-flux-reconstruction">Spectral Flux Reconstruction</h2> <hr> <p>To evaluate transient reconstruction we used the \(L_2\) error between spectral flux onset envelopes, which are commonly used for onset detection. We present a couple examples here to provide more insight into how the transient TCN network impacts this metric.</p> <p>First, here is a snare drum example where the transient network clearly improves the spectral flux over using sinusoids and sinusoids plus noise only.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/research/drumblender_snare_sf-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/research/drumblender_snare_sf-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/research/drumblender_snare_sf-1400.webp"></source> <img src="/assets/img/research/drumblender_snare_sf.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Snare Drum Spectral Flux Reconstruction" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Audio files containing the original (ground truth) followed shortly by a reconstruction:</p> <table> <tbody> <tr> <td>\(S + N\)</td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/snare_noise_combined.mp3" type="audio/mpeg"></source></audio></td> </tr> <tr> <td>\(T(S) + N\)</td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/snare_transient_combined.mp3" type="audio/mpeg"></source></audio></td> </tr> </tbody> </table> <p><br></p> <div align="center"> <b>Which version do you think has a better transient?</b> </div> <p><br></p> <p>Now, here is a counter example of a hihat where the transient network does not improve the spectral flux onset metric.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/research/drumblender_hihat_sf-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/research/drumblender_hihat_sf-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/research/drumblender_hihat_sf-1400.webp"></source> <img src="/assets/img/research/drumblender_hihat_sf.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Hi Hat Spectral Flux Reconstruction" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Audio files containing the original (ground truth) followed shortly by a reconstruction. We can also hear artefacts in the noise reconstruction – potentially attempting to make up for a lack of higher harmonics in the sinusoidal modelling.</p> <table> <tbody> <tr> <td>\(S + N\)</td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/hihat_noise_combined.mp3" type="audio/mpeg"></source></audio></td> </tr> <tr> <td>\(T(S) + N\)</td> <td><audio controls="" class="player"><source src="/assets/audio/drumblender/hihat_transient_combined.mp3" type="audio/mpeg"></source></audio></td> </tr> </tbody> </table> <p><br></p> <h2 id="transient-tcn-configuration">Transient TCN Configuration</h2> <hr> <p>Our transient reconstruction temporal convolution network (TCN) \(T()\) is based on the TCN by Christian Steinmetz and Joshua Reiss for modelling the LA2A compressor [1]. However, we use an increasing dilation rate of factor two instead of ten as we aren’t as interested in modeling long-term temporal dependecies. The details of the model are outlined in the figure below.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/research/tcn_diagram-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/research/tcn_diagram-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/research/tcn_diagram-1400.webp"></source> <img src="/assets/img/research/tcn_diagram.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="TCN Diagram" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The input to the TCN is an audio waveform \(x\). An input projection layer maps this input to 32 output channels \(c_{out}\). All intermediate TCN operations use 32 hidden channels. There are 8 dilated TCN blocks (i.e., 8 layers). Each dilated TCN block comprises a causal pad which ensures the output \(h_{l}\) of the convolution at the current layer has the same length as the input to that layer \(h_{l-1}\). The main temporal convolution at each layer uses a kernel size of \(k=13\) and a dilation equal to \(2^l\) where \(l\) is the layer number. The output is modulated via an affine transform in a feature-wise linear modulation (FiLM) [2] block. Scale and shift parameters for the affine transformation are learned independently for each layer \(l\) using a linear projection. A gaussian error linear unit (GELU) acivation is applied before mixing with the residual. Finally, an output projection convolutional layer maps back to a single channel, the ouput of which is \(\hat{y}\).</p> <p><br></p> <h2 id="speed-tests">Speed Tests</h2> <hr> <p>To evaluate the computational efficiency of our synthesis method we tested the rendering speed of various components using different frame sizes. While achieving real-time performance was not a goal of this work, future work includes investigating how these components might be incorporated into a real-time performance system.</p> <p>Four configurations of the model were tested: 1) The transient TCN \(T()\) without the transient encoder stage; 2) the transient TCN preceded by the transient encoder, which produces the latent transient embedding used for FiLM; 3) the noise synthesizer with the noise encoder; 4) the full model with all the encoders and sinusoidal synthesis. Since CQT sinusoidal modeling synthesis is a preprocessing step and is not causal, we do not include it in these calculations.</p> <p>Realtime factor is calculated as the frame size in seconds at a sampling rate of 48kHz divided by the time required to compute that frame size. A frame size greater than 1 is required for real time processing.</p> <p>Computed on an Apple M1 Pro (cpu-only).</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/research/realtime_test-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/research/realtime_test-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/research/realtime_test-1400.webp"></source> <img src="/assets/img/research/realtime_test.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Realtime Factor" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><br></p> <h2 id="references">References</h2> <hr> <p>[1] Steinmetz, Christian J., and Joshua D. Reiss. “Efficient neural networks for real-time modeling of analog dynamic range compression.” arXiv preprint arXiv:2102.06200 (2021).</p> <p>[2] Perez, Ethan, et al. “Film: Visual reasoning with a general conditioning layer.” Proceedings of the AAAI Conference on Artificial Intelligence. Vol. 32. No. 1. 2018.</p> </article> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> © Copyright 2025 Jordie Shier. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. <a target="_blank" href="https://icons8.com/icon/12100/electronic-music" rel="noopener noreferrer">Electronic Music</a> icon by <a target="_blank" href="https://icons8.com" rel="noopener noreferrer">Icons8</a> </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>